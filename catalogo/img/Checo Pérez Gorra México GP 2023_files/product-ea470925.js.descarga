import{g as getGlobalStore,m as mergePropsFromScriptTags,A as AddToCartButton,r as registerWebComponent,V as VolumeDiscountWidget,a as VolumeDiscountSelectorWidget,b as AddToCartButtonDefaultProps,c as VolumeDiscountWidgetDefaultProps,d as VolumeDiscountSelectorWidgetDefaultProps}from"./VolumeDiscountSelectorWidget-313411d2.js";import{c as createSignal,a as createEffect,b as createComponent,i as insert,S as Show,F as For,d as createRenderEffect,e as className,s as style,f as setAttribute,t as template,o as onMount}from"./vendor-1008a1aa.js";const classes$1={planet_pwvsc:"_planet_pwvsc_1hst9_1",planet_pwvsc__title:"_planet_pwvsc__title_1hst9_15",planet_pwvsc__price:"_planet_pwvsc__price_1hst9_20",planet_pwvsc__comparedPrice:"_planet_pwvsc__comparedPrice_1hst9_24",planet_pwvsc__body:"_planet_pwvsc__body_1hst9_29",planet_pwvsc__variantSelector:"_planet_pwvsc__variantSelector_1hst9_35"};function applyDiscount(price,comparedPrice,discount){const discounted={price:price,comparedPrice:comparedPrice};if(null==discount?.amount)return discounted;switch(discount.discountType){case"FIXED_PRICE":if(discount.discountAmount<=0)return discounted;discounted.price=discount.discountAmount;break;case"RELATIVE_DECREASE":if(discount.discountAmount<=0||discount.discountAmount>1)return discounted;discounted.price*=discount.discountAmount;break;case"ABSOLUTE_DECREASE":if(discount.discountAmount>0)return discounted;discounted.price+=discount.discountAmount;break;default:return discounted}return discounted.comparedPrice=comparedPrice||price,discounted}function getVariantFromProps(props){const selected=props.product.variants.find((d=>d.id==props.selected));if(null==selected)return null;return{...selected,...applyDiscount(selected.price,selected.comparedPrice,props.discount)}}function styleFromPropps(props){return{"--planet_pwvsc-color-title":props.appearence.titleColor,"--planet_pwvsc-color-price":props.appearence.priceColor,"--planet_pwvsc-color-comparedPrice":props.appearence.comparedPriceColor}}function vmFromConfig$1(props){if(null==props?.selected||null==props.store)return null;const vm={variant:getVariantFromProps(props),style:styleFromPropps(props),store:props.store,hasVariantSelection:!0};return 1==props.product.variants.length&&vm.variant.description.toLocaleLowerCase().includes("default")&&(vm.hasVariantSelection=!1),null==vm.variant?null:vm}const _tmpl$$1=template("<select></select>",2),_tmpl$2$1=template("<div><img><div><p></p><p><span></span> <span></span></p></div></div>",13),_tmpl$3=template("<option></option>",2);function ProductWithVariantSelectorCard(props){const[vm,setVm]=createSignal(vmFromConfig$1());return createEffect((()=>{setVm(vmFromConfig$1(props))})),createComponent(Show,{get when(){return null!=vm()},get children(){const _el$=_tmpl$2$1.cloneNode(!0),_el$2=_el$.firstChild,_el$3=_el$2.nextSibling,_el$4=_el$3.firstChild,_el$5=_el$4.nextSibling,_el$6=_el$5.firstChild,_el$8=_el$6.nextSibling.nextSibling;return insert(_el$4,(()=>props.product.description)),insert(_el$3,createComponent(Show,{get when(){return!0===vm().hasVariantSelection},get children(){const _el$9=_tmpl$$1.cloneNode(!0);return _el$9.addEventListener("change",(e=>{props?.onChange?.(+e.currentTarget.value)})),insert(_el$9,createComponent(For,{get each(){return props.product.variants},children:variant=>(()=>{const _el$10=_tmpl$3.cloneNode(!0);return insert(_el$10,(()=>variant.description)),createRenderEffect((()=>_el$10.value=variant.id)),_el$10})()})),createRenderEffect((()=>className(_el$9,classes$1.planet_pwvsc__variantSelector))),createRenderEffect((()=>_el$9.value=props.selected)),_el$9}}),null),createRenderEffect((_p$=>{const _v$=classes$1.planet_pwvsc,_v$2=vm().style,_v$3=props.product.image,_v$4=classes$1.planet_pwvsc__body,_v$5=classes$1.planet_pwvsc__title,_v$6=classes$1.planet_pwvsc__priceContainer,_v$7=classes$1.planet_pwvsc__price,_v$8=vm().store.format.toShopifyFormat(vm().variant.price),_v$9=classes$1.planet_pwvsc__comparedPrice,_v$10=vm().store.format.toShopifyFormat(vm().variant.comparedPrice);return _v$!==_p$._v$&&className(_el$,_p$._v$=_v$),_p$._v$2=style(_el$,_v$2,_p$._v$2),_v$3!==_p$._v$3&&setAttribute(_el$2,"src",_p$._v$3=_v$3),_v$4!==_p$._v$4&&className(_el$3,_p$._v$4=_v$4),_v$5!==_p$._v$5&&className(_el$4,_p$._v$5=_v$5),_v$6!==_p$._v$6&&className(_el$5,_p$._v$6=_v$6),_v$7!==_p$._v$7&&className(_el$6,_p$._v$7=_v$7),_v$8!==_p$._v$8&&(_el$6.innerHTML=_p$._v$8=_v$8),_v$9!==_p$._v$9&&className(_el$8,_p$._v$9=_v$9),_v$10!==_p$._v$10&&(_el$8.innerHTML=_p$._v$10=_v$10),_p$}),{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0,_v$10:void 0}),_el$}})}const classes_planet_bdcw="_planet_bdcw_1w7h8_1",classes_planet_bdcw__title="_planet_bdcw__title_1w7h8_18",classes_planet_bdcw__buyButton="_planet_bdcw__buyButton_1w7h8_24",classes_planet_bdcw__total="_planet_bdcw__total_1w7h8_36",classes_planet_bdcw__totalTitle="_planet_bdcw__totalTitle_1w7h8_36",classes_planet_bdcw__totalPrice="_planet_bdcw__totalPrice_1w7h8_37",classes_planet_bdcw__totalComparedPrice="_planet_bdcw__totalComparedPrice_1w7h8_38",classes_planet_bdcw__productSeparator="_planet_bdcw__productSeparator_1w7h8_56",storeVariantMetadataPrefix="variant_metadata_";function vmFromConfig(store,selection){if(null==store)return null;const metadataKey=storeVariantMetadataPrefix+store.product.selectedVariant?.id,metadata=store.bundleDiscountCarousel[metadataKey];if(!metadata?.widget)return null;const vm={metadata:{...metadata},totalPrice:"",totalComparedPrice:"",selection:[],productCardAppearence:{titleColor:metadata.widget.productItemTitleColor,priceColor:metadata.widget.productItemPriceColor,comparedPriceColor:metadata.widget.productItemComparedPriceColor,showImage:!0,layout:"horizontal"},style:(config=metadata,null==config||null==config?.widget?{}:(config.widget.buyButtonBorderRadius||(config.widget.buyButtonBorderRadius=config.widget.borderRadius??"0px"),config.widget.borderWidth||(config.widget.borderWidth="0px",config.widget.borderColor&&(config.widget.borderWidth="2px")),{"--planet_bdcw-color-title":config.widget.titleColor,"--planet_bdcw-color-productCardTitle":config.widget.productItemTitleColor,"--planet_bdcw-color-productCardPrice":config.widget.productItemPriceColor,"--planet_bdcw-color-productCardComparedPrice":config.widget.productItemComparedPriceColor,"--planet_bdcw-bgColor-buyButton":config.widget.buyButtonBgColor,"--planet_bdcw-color-buyButton":config.widget.buyButtonTextColor,"--planet_bdcw-bgColor":config.widget.backgroundColor??"transparent","--planet_bdcw-borderColor":config.widget.borderColor??"transparent","--planet_bdcw-borderWidth":config.widget.borderWidth,"--planet_bdcw-borderRadius":config.widget.borderRadius??"0px","--planet_bdcw-buyButtonBorderRadius":config.widget.buyButtonBorderRadius,"--planet_bdcw-padding":null!=config.widget.backgroundColor||null!=config.widget.borderColor?"16px":"0px"}))};var config;try{const extendedProductRecommendation=function(store){const metadataKey=storeVariantMetadataPrefix+store.product.selectedVariant?.id,metadata=store.bundleDiscountCarousel[metadataKey];let currentProductIndex=0;for(let i=0;i<metadata.products.length;i++)if(-1!=metadata.products[i].variants.findIndex((d=>d.id==store.product.selectedVariant?.id))){currentProductIndex=i;break}const productRecommendation=[...metadata.products],variantsWithSameWidget=Object.entries(store.bundleDiscountCarousel).filter((([key,value])=>value?.widgetId==store.bundleDiscountCarousel[metadataKey]?.widgetId)),currentProductEntry={image:store.product.product.images[0],description:store.product.product.title,variants:variantsWithSameWidget.map((([metaId,value])=>{const variantId=metaId.slice(storeVariantMetadataPrefix.length),variant=store.product.product.variants.find((d=>d.id==variantId));return{id:variant.id,description:variant.title,price:store.format.fromShopifyInteger(variant.price),comparedPrice:store.format.fromShopifyInteger(variant.compare_at_price)}}))};return productRecommendation[currentProductIndex]=currentProductEntry,productRecommendation}(store);vm.metadata.products=extendedProductRecommendation}catch{}let totalPrice=0,totalComparedPrice=0;for(let i=0;i<vm.metadata.products.length;i++){const selectedId=selection?.[i]||vm.metadata.products[i].variants[0].id,selected=vm.metadata.products[i].variants.find((d=>d.id==selectedId)),discounted=applyDiscount(selected.price,selected.comparedPrice,metadata.discount.discount);totalPrice+=discounted.price,totalComparedPrice+=discounted.comparedPrice||discounted.price,vm.selection.push(selectedId)}return vm.totalPrice=store.format.toShopifyFormat(totalPrice),vm.totalComparedPrice=store.format.toShopifyFormat(totalComparedPrice),vm}const _tmpl$=template("<div><h1></h1><div><h1>TOTAL</h1><b></b> <span></span></div><div></div></div>",14),_tmpl$2=template("<span>+</span>",2);registerWebComponent("add-to-cart-button",AddToCartButton,AddToCartButtonDefaultProps),registerWebComponent("planet-volume-discount-widget",VolumeDiscountWidget,VolumeDiscountWidgetDefaultProps),registerWebComponent("planet-volume-discount-selector-widget",VolumeDiscountSelectorWidget,VolumeDiscountSelectorWidgetDefaultProps),registerWebComponent("planet-bundle-discount-carousel",(function(props){const[store,setStore]=createSignal(null),[vm,setVm]=createSignal(vmFromConfig(null));return onMount((async()=>{const _store=getGlobalStore();if(null!=store)return mergePropsFromScriptTags(_store),void setStore(_store);setTimeout((()=>{const _store2=getGlobalStore();mergePropsFromScriptTags(_store2),setStore(_store2)}),500)})),createEffect((()=>{const _store=store();null!=_store&&(setVm(vmFromConfig(_store)),_store.subscribeToChanges("product",(event=>{"selectedVariant"==event.detail.key&&setVm(vmFromConfig(_store))})))})),createComponent(Show,{get when(){return null!=vm()},get children(){const _el$=_tmpl$.cloneNode(!0),_el$2=_el$.firstChild,_el$3=_el$2.nextSibling,_el$4=_el$3.firstChild,_el$5=_el$4.nextSibling,_el$7=_el$5.nextSibling.nextSibling,_el$8=_el$3.nextSibling;return insert(_el$2,(()=>vm()?.metadata.widget.title)),insert(_el$,createComponent(For,{get each(){return vm()?.metadata.products},children:(item,index)=>[createComponent(ProductWithVariantSelectorCard,{get store(){return store()},product:item,get appearence(){return vm().productCardAppearence},get selected(){return vm().selection[index()]},get discount(){return vm().metadata.discount.discount},onChange:selected=>{const newSelection=[...vm().selection];newSelection[index()]=selected,setVm(vmFromConfig(store(),newSelection))}}),(()=>{const _el$9=_tmpl$2.cloneNode(!0);return createRenderEffect((()=>className(_el$9,classes_planet_bdcw__productSeparator))),_el$9})()]}),_el$3),insert(_el$8,createComponent(AddToCartButton,{get label(){return vm()?.metadata.widget.buyButtonText||"Add to cart"},get variantIds(){return vm().selection}})),createRenderEffect((_p$=>{const _v$=classes_planet_bdcw,_v$2=vm()?.style,_v$3=classes_planet_bdcw__title,_v$4=classes_planet_bdcw__total,_v$5=classes_planet_bdcw__totalTitle,_v$6=classes_planet_bdcw__totalPrice,_v$7=vm().totalPrice,_v$8=classes_planet_bdcw__totalComparedPrice,_v$9=vm().totalComparedPrice,_v$10=classes_planet_bdcw__buyButton;return _v$!==_p$._v$&&className(_el$,_p$._v$=_v$),_p$._v$2=style(_el$,_v$2,_p$._v$2),_v$3!==_p$._v$3&&className(_el$2,_p$._v$3=_v$3),_v$4!==_p$._v$4&&className(_el$3,_p$._v$4=_v$4),_v$5!==_p$._v$5&&className(_el$4,_p$._v$5=_v$5),_v$6!==_p$._v$6&&className(_el$5,_p$._v$6=_v$6),_v$7!==_p$._v$7&&(_el$5.innerHTML=_p$._v$7=_v$7),_v$8!==_p$._v$8&&className(_el$7,_p$._v$8=_v$8),_v$9!==_p$._v$9&&(_el$7.innerHTML=_p$._v$9=_v$9),_v$10!==_p$._v$10&&className(_el$8,_p$._v$10=_v$10),_p$}),{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0,_v$10:void 0}),_el$}})}),{});
